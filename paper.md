---
title: 'POST-PROMD: an open-source POST-PROcessing software for Molecular Dynamics simulations'
tags:
  - molecular dynamics
  - phase transition
  - Fortran
  - Bash
authors:
  - name: Ashkan Shekaari
    orcid: 0000-0002-7434-467X
    affiliation: Department of Physics, K. N. Toosi University of Technology, Tehran 15875-4416, Iran
date: 06 May 2025

# Summary {#summary .unnumbered}

In this work a new software named POST-PROMD has been developed,
which is capable of computing three main phase transition quantities
used in the area of computational condensed matter physics, including
the Lindemann index, mean square displacement (MSD) of atoms, and radial
distribution function (RDF) of systems of particles only via
post-processing molecular dynamics (MD) simulations outputs. POST-PROMD
runs independently (is not a module patched to any other software), is
length-scale-independent (consistent with both quantum mechanical and
classical simulations), is released for the first time under the GNU GPL
(Version 3) as a free and open-source package, has originally been
written to post-process the atomic-positions output file generated
during Car-Parrinello MD simulations of [Quantum ESPRESSO]{.smallcaps},
and is capable of post-processing MD output files of any other software
as well.

# Statement of Need {#statement-of-need .unnumbered}

One of the most important capabilities of [Quantum
ESPRESSO]{.smallcaps} [@0] is to perform density functional molecular
dynamics (DFMD) simulations within both Car-Parrinello (CP) [@1] and
Born-Oppenheimer (BO) [@2; @3] frameworks. However, there is still a
lack of required codes/modules to post-process raw outputs of such MD
simulations generated by the CPV package. As an illustration, the output
file `"cp.pos"` of CPMD simulations---including atomic positions of the
system at every time-step---contains important information about phase
transition/finite-temperature behavior/dynamics of that system,
extracting information from which is left to the user.

To this end, i.e., to extract such important information contained in
`"cp.pos"`, we have written a post-processing package for MD
simulations, called POST-PROMD (acronym for \"a POST-PROcessor for
Molecular Dynamics simulations\"), which computes three main phase
transition indicators, including (i) the Lindemann index of the whole
system, (ii) mean square displacement (MSD) of every atom/particle of
the system, and (iii) radial distribution function (RDF) of the whole
system.

The present package has been written both in Fortran 95 [@frt] and Linux
Bash [@lnx; @bsh], and is released as a free and open-source package,
with assigned version `v.1.0.0`, under the GNU General Public License
(Version 3, 29 June 2007) [@gg].

# State of the Field {#state-of-the-field .unnumbered}

There is no software tools to compute the aforementioned phase
transition quantities for [Quantum ESPRESSO]{.smallcaps} users, and this
is the main reason why the CPV package of [Quantum
ESPRESSO]{.smallcaps} has not yet become a standard in quantum MD
simulations. As a result, the POST-PROMD package fills the gap.

# []{#sec:phase label="sec:phase"}Phase Transition in Solids {#phase-transition-in-solids .unnumbered}

Investigating phase transition/finite-temperature behavior of the
condensed matter at the computational level of research using MD
simulations is carried out via calculating a number of indicators the
three important of which are the Lindemann index, MSD, and RDF, as
mentioned before. These quantities are prevalently used to probe phase
transition in solid materials, namely solid-to-liquid transition;
however, they can also be applied to so-called few-body systems of
atoms/molecules whose bulk phases are not solid. The point at which
phase transition takes place is the same as the melting temperature
($T_m$) of the solid; at this point, temperature dependence of the three
phase transition indicators aforementioned undergo a sudden, substantial
increase compared to their former behaviors. The facts aforementioned
have clearly been demonstrated in an investigation on phase transition
of B$_{36}$ nanocluster [@b36]. In the following, we describe the three
phase transition quantities.

# []{#sec:lind label="sec:lind"}The Lindemann Index {#the-lindemann-index .unnumbered}

The Lindemann index $\Delta_{rms}$, also known as global Lindemann
index, or root-mean-square bond length fluctuation [@lind], is indeed
the extent of fluctuations in bond lengths between atoms/particles of
the system, averaged both over all those atoms, and the total time span
of the MD simulation. This quantity is defined as $$\label{eq:1}
    \Delta_{rms} = \frac{2}{N(N-1)}\sum_{i>j}\frac{\bigg({\langle{r_{ij}^2}\rangle}_{t}-{{\langle{r_{ij}}\rangle}_{t}}^2\bigg)^{1/2}}{{\langle{r_{ij}}\rangle}_{t}},$$
where $N$ is total number of atoms, $r_{ij}$ is distance between atoms
$i$ and $j$, and $\langle{...}\rangle_{t}$ is time ($t$) average over
the entire trajectory/simulation. $2/N(N-1)$ also means average over
total number of atomic pairs/bonds $N(N-1)/2$. The two modules of
POST-PROMD, namely `"lind.sh"` and `"ln.source"` are used to compute the
Lindemann index of the system according to
Eq. [\[eq:1\]](#eq:1){reference-type="ref" reference="eq:1"}.

# []{#sec:msd label="sec:msd"}Mean Square Displacement (MSD) {#mean-square-displacement-msd .unnumbered}

In contrast to the Lindemann index and radial distribution function,
which are quantities related to the entire system, MSD is a
single-particle quantity, and POST-PROMD consequently computes it for
every individual atom of the system according to $$\label{eq:2}
    \langle{{\bf{r}}_{I}^{2}(t)\rangle}=\frac{1}{n}\sum_{i=1}^{n}\bigg[{\bf{R}}_{I}\left(t_{0i}+t\right)-{\bf{R}}_{I}\left(t_{0i}\right)\bigg]^{2},$$
where we average over $n$ different time origins $t_{0i}$ distributed
over the entire trajectory with the interval `dt0` (included as an input
in the file `"par.input"`, described later on in
section [\[sec:inps\]](#sec:inps){reference-type="ref"
reference="sec:inps"}) between any two consecutive $t_{0i}$ for the
average. The $I$ runs over number $N$ of atoms, and ${\bf{R}}_{I}$ is
the position vector of the $I$th atom with respect to the center of mass
(COM) of the system. The two modules `"msd.sh"` and `"msd.source"`
compute MSD according to Eq. [\[eq:2\]](#eq:2){reference-type="ref"
reference="eq:2"}.

# Radial Distribution Function (RDF) {#radial-distribution-function-rdf .unnumbered}

The quantity RDF \[$g(r)$\], being calculated both in two and three
spatial dimensions, computes the average number $\langle{N}\rangle$ of
atoms within the shell volume $V_s$ ($=2\pi rdr$ in two, and
$4\pi r^{2}dr$ in three dimensions) of radius $r$ around COM of the
system, between $r-dr/2$ and $r+dr/2$, according to $$\label{eq:3}
    g(r)=\frac{\langle{N}\rangle}{N}\bigg/V_s,$$ where $dr$ is shell
width. Indeed, POST-PROMD computes the average of atoms within each
shell over the entire simulation, and then repeats the same for the next
shell until reaching the outermost that encompasses the entire system.
This is why RDF calculation takes a longer time compared to the
Lindemann index or MSD. The two modules `"rdf.sh"` and `"rdf.source"`
compute RDF according to Eq. [\[eq:3\]](#eq:3){reference-type="ref"
reference="eq:3"}.

# []{#sec:inps label="sec:inps"}The Input

So far, we have demonstrated POST-PROMD modules that perform
calculations (placed in `<POST-PROMD_ROOT_DIRECTORY/src>`). The Bash
scripts suffixed with `".sh"` use the same input files `"cp.pos"` and
`"par.input"` to do calculation. The former (`"cp.pos"`) is indeed an
output file, formerly generated by the CPV package of [Quantum
ESPRESSO]{.smallcaps}; the latter (`"par.input"`), on the other hand, is
completely user-defined, containing a number of numerical parameters
some of which have already been defined in MD input file of [Quantum
ESPRESSO]{.smallcaps}. These input parameters are described in detail,
as follows:

-   `n0` = Total number of particles (also included in MD input file of
    [Quantum ESPRESSO]{.smallcaps}).

-   `nstep0` = Total number of steps (also included in MD input file of
    [Quantum ESPRESSO]{.smallcaps}).

-   `iprint0` = Number of steps between successive output writings\
    (also included in MD input file of [Quantum ESPRESSO]{.smallcaps}).

-   `ign0` = Number of steps for thermalization/thermal equilibration,
    to have reliable statistical averages. In fact, whether or not the
    initial atomic positions are random, it takes a time for the entire
    system to reach thermal equilibrium according to the target
    temperature defined in the simulation. Over this time interval,
    statistical averages, such as total energy, are not valid because
    they are only meaningful at thermal equilibrium according to theory
    (thermodynamics/statistical mechanics). Usually, integer values
    between 50 and 500 steps are suitable. Evidently, systems with
    larger numbers of particles take longer times/steps to reach thermal
    equilibrium (to be more accurate, the user has to check the diagram
    of total energy vs. simulation step/index to determine the time/step
    at which total energy begins to get converged).

-   `dt0` = Time-step, included in (1st row, 2nd column) of the MD
    output file `"cp.pos"`.

-   `dt00` = Time-step in MD input file of [Quantum
    ESPRESSO]{.smallcaps}.

-   `delta_r0` = Increment value in radius $r$ ranging from zero (COM of
    the system) to the outermost shell encompassing the whole system. It
    is a very sensitive parameter; the value 0.0005 Å works well.

-   `rmax0` = Distance from COM to the outermost shell of the system.
    For example, the value 5 Å is suitable for B$_{36}$
    nanocluster [@b36].

Note that in `"par.input"`, there must not be any blank space before and
after the equal signs (`=`). The sample input files (`"cp.pos"` and
`"par.input"`) have also been placed in
`<POST-PROMD_ROOT_DIRECTORY/input>`.

# How to Run {#how-to-run .unnumbered}

Needless to install, POST-PROMD would be ready to run only via unzipping
the source file `post-promd-v.1.0.0.tar.gz`. To this end, the user needs
to pursue the following simple steps:

1.  Unzip the source file.

2.  Place `"cp.pos"` in\
    `<POST-PROMD_ROOT_DIRECTORY/src>`

3.  Edit `"par.input"` according to\
    your MD setup, then place it in\
    `<POST-PROMD_ROOT_DIRECTORY/src>`

4.  Open a terminal in\
    `<POST-PROMD_ROOT_DIRECTORY/src>`

5.  To compute the Lindemann index, run in\
    terminal: `bash lind.sh`

6.  To compute MSD, run in terminal:\
    `bash msd.sh`

7.  To compute RDF, run in terminal:\
    `bash rdf.sh`

Note that the Fortran part of POST-PROMD, namely the files suffixed by
`".source"`, are compatible with the Intel Fortran Compiler ifort;
therefore, the user either has to use ifort, or modify the `".source"`
files simply via replacing the keyword `"ifort"` with other available
Fortran compilers, such as `gfortran`, `mpif90`, etc. The output files
generated by POST-PROMD are also described as follows:

1.  The output of `bash lind.sh` is displayed in terminal.

2.  Those of `bash msd.sh` will be in the directory
    `<msd_output_files>`, each of which belongs to one atom of the
    system. Each of these files, named with the template `"msd***.out"`,
    contain two columns of numerical data, which, in order, are:
    time-step, and MSD. The user has to plot these files.

3.  The output of `bash rdf.sh`, namely `"rdf5.out"`, will be in the
    directory `<rdf_output_file>`; the number `’5’` stands for the five
    columns of numerical data contained in that file, being, in order: r
    (radius), rdf (RDF values) on xy plane, rdf on xz plane, rdf on yz
    plane, and rdf in three dimensions. The user also has to plot
    `"rdf5.out"`.

# Example Files {#example-files .unnumbered}

The present distribution of POST-PROMD also contains example files,
placed in the directory `<POST-PROMD_ROOT_DIRECTORY/example>`, which are
related to the CPMD simulation of the unit cell of SLSiN (single-layer
silicon nitride; chemical formula: Si$_3$N$_4$; containing 14
atoms) [@sl], at $T=5$ K. The related outputs have also been placed in
the directory `<POST-PROMD_ROOT_DIRECTORY/example/reference>`.

# References

